<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Module 2 | Statistics in R</title>
  <meta name="description" content="<p>This is a trial run of putting out a book for a stats class.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Module 2 | Statistics in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a trial run of putting out a book for a stats class.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Module 2 | Statistics in R" />
  
  <meta name="twitter:description" content="<p>This is a trial run of putting out a book for a stats class.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Phil Hahn &amp; Leo Ohyama" />


<meta name="date" content="2022-06-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="module-1.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>1.2</b> Render book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>1.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="module-1.html"><a href="module-1.html"><i class="fa fa-check"></i><b>2</b> Module 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="module-1.html"><a href="module-1.html#a.-introduction-to-data-visualization"><i class="fa fa-check"></i><b>2.1</b> 1A. Introduction to Data Visualization</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="module-1.html"><a href="module-1.html#continuous-variables"><i class="fa fa-check"></i><b>2.1.1</b> Continuous Variables</a></li>
<li class="chapter" data-level="2.1.2" data-path="module-1.html"><a href="module-1.html#fancy-scatterplots"><i class="fa fa-check"></i><b>2.1.2</b> Fancy Scatterplots</a></li>
<li class="chapter" data-level="2.1.3" data-path="module-1.html"><a href="module-1.html#continuous-variables-1"><i class="fa fa-check"></i><b>2.1.3</b> Continuous Variables</a></li>
<li class="chapter" data-level="2.1.4" data-path="module-1.html"><a href="module-1.html#different-types-of-plots-for-categorical-data-with-ggplot2"><i class="fa fa-check"></i><b>2.1.4</b> Different types of plots for categorical data with ggplot2</a></li>
<li class="chapter" data-level="2.1.5" data-path="module-1.html"><a href="module-1.html#breakout-group-challenge"><i class="fa fa-check"></i><b>2.1.5</b> Breakout group challenge</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="module-1.html"><a href="module-1.html#b.-introduction-to-regression"><i class="fa fa-check"></i><b>2.2</b> 1B. Introduction to Regression</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="module-1.html"><a href="module-1.html#an-example-of-linear-regression-in-r"><i class="fa fa-check"></i><b>2.2.1</b> An Example of Linear Regression in R</a></li>
<li class="chapter" data-level="2.2.2" data-path="module-1.html"><a href="module-1.html#regression-challenge"><i class="fa fa-check"></i><b>2.2.2</b> Regression Challenge</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="module-1.html"><a href="module-1.html#c.-introduction-to-anova"><i class="fa fa-check"></i><b>2.3</b> 1C. Introduction to ANOVA</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="module-1.html"><a href="module-1.html#example-of-a-one-way-anova-in-r"><i class="fa fa-check"></i><b>2.3.1</b> Example of a one-way ANOVA in R</a></li>
<li class="chapter" data-level="2.3.2" data-path="module-1.html"><a href="module-1.html#anova-challenge"><i class="fa fa-check"></i><b>2.3.2</b> ANOVA Challenge</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="module-1.html"><a href="module-1.html#extra-data-visualization"><i class="fa fa-check"></i><b>2.4</b> Extra Data Visualization</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="module-1.html"><a href="module-1.html#adding-averages-to-plots-part-2"><i class="fa fa-check"></i><b>2.4.1</b> Adding averages to plots part 2</a></li>
<li class="chapter" data-level="2.4.2" data-path="module-1.html"><a href="module-1.html#r-challenge"><i class="fa fa-check"></i><b>2.4.2</b> R Challenge</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="module-2.html"><a href="module-2.html"><i class="fa fa-check"></i><b>3</b> Module 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="module-2.html"><a href="module-2.html#a.-data-management-part-1"><i class="fa fa-check"></i><b>3.1</b> 2A. Data Management Part 1</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="module-2.html"><a href="module-2.html#making-and-modifying-variables"><i class="fa fa-check"></i><b>3.1.1</b> Making and modifying variables</a></li>
<li class="chapter" data-level="3.1.2" data-path="module-2.html"><a href="module-2.html#variables-with-the-tidyverse"><i class="fa fa-check"></i><b>3.1.2</b> Variables with the tidyverse</a></li>
<li class="chapter" data-level="3.1.3" data-path="module-2.html"><a href="module-2.html#reshape-data-for-better-usability"><i class="fa fa-check"></i><b>3.1.3</b> Reshape data for better usability</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="module-2.html"><a href="module-2.html#b.-data-management-part-2"><i class="fa fa-check"></i><b>3.2</b> 2B. Data Management Part 2</a></li>
<li class="chapter" data-level="3.3" data-path="module-2.html"><a href="module-2.html#c.-data-exploration"><i class="fa fa-check"></i><b>3.3</b> 2C. Data Exploration</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="module-2.html"><a href="module-2.html#distributions-summary-statistics"><i class="fa fa-check"></i><b>3.3.1</b> Distributions &amp; summary statistics</a></li>
<li class="chapter" data-level="3.3.2" data-path="module-2.html"><a href="module-2.html#examining-for-outliers"><i class="fa fa-check"></i><b>3.3.2</b> Examining for outliers</a></li>
<li class="chapter" data-level="3.3.3" data-path="module-2.html"><a href="module-2.html#explore-relationships"><i class="fa fa-check"></i><b>3.3.3</b> Explore relationships</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="module-2" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Module 2<a href="module-2.html#module-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="a.-data-management-part-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 2A. Data Management Part 1<a href="module-2.html#a.-data-management-part-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will practice plotting data using the iris dataset.</p>
<p>We will use the iris dataset for this section</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="module-2.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris) <span class="co"># load data (already exists in base R)</span></span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="module-2.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris) <span class="co"># print first 6 lines of dataset</span></span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="module-2.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(iris) <span class="co"># print last 6 lines of dataset</span></span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 145          6.7         3.3          5.7         2.5 virginica
## 146          6.7         3.0          5.2         2.3 virginica
## 147          6.3         2.5          5.0         1.9 virginica
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="module-2.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris) <span class="co"># print &#39;structure&#39; of dataset giving you info about each column</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div id="making-and-modifying-variables" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Making and modifying variables<a href="module-2.html#making-and-modifying-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here’s how we make a new column that is a unique number:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="module-2.html#cb105-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Plant <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(iris<span class="sc">$</span>Species)</span></code></pre></div>
<p>Here’s how we make a new column that is total petal and sepal length:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="module-2.html#cb106-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>PetSep.Length <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Length<span class="sc">+</span>iris<span class="sc">$</span>Sepal.Length</span></code></pre></div>
<p>Here’s how to make a new column that log-transforms PetSep.Length:
iris<span class="math inline">\(lnPS.Len &lt;- log(iris\)</span>PetSep.Length)</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="module-2.html#cb107-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>lnPS.Len <span class="ot">&lt;-</span> <span class="fu">log</span>(iris<span class="sc">$</span>PetSep.Length)</span></code></pre></div>
<p>Here’s how to make a new column for ‘genus.’ The only values you want is “Iris”:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="module-2.html#cb108-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Genus <span class="ot">&lt;-</span> <span class="st">&#39;Iris&#39;</span></span></code></pre></div>
<p>Here’s how to combine two columns:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="module-2.html#cb109-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>GenSpp <span class="ot">&lt;-</span> <span class="fu">paste</span>(iris<span class="sc">$</span>Genus, iris<span class="sc">$</span>Species, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<p>Here’s how to change Species ‘versicolor’ to ‘versi’ in the GenSpp column:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="module-2.html#cb110-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>GenSpp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&#39;versicolor&#39;</span>, <span class="st">&#39;versi&#39;</span>, iris<span class="sc">$</span>GenSpp )  <span class="do">## looks for &#39;versicolor&#39; and replaces it with &#39;versi&#39; in the column iris$Species</span></span></code></pre></div>
<p>sub() can be used for replacement but will only do 1 replacement and gsub() can also be used for replacement but with all matching instances.</p>
<p>You can use gsub() to add genus name to species column (alternative to making new column and then pasting together).</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="module-2.html#cb111-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>GenSpp1 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&#39;.*^&#39;</span>, <span class="st">&#39;Iris_&#39;</span>, iris<span class="sc">$</span>Species)</span></code></pre></div>
</div>
<div id="variables-with-the-tidyverse" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Variables with the tidyverse<a href="module-2.html#variables-with-the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="module-2.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)      <span class="co"># load package tidyverse (install if needed)</span></span>
<span id="cb112-2"><a href="module-2.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb112-3"><a href="module-2.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)               <span class="co"># reload iris to clear changes from above</span></span>
<span id="cb112-4"><a href="module-2.html#cb112-4" aria-hidden="true" tabindex="-1"></a>iris1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris) <span class="co"># load iris and convert to tibble</span></span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="module-2.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris1)     <span class="do">## similar to str(), just glimpses data</span></span></code></pre></div>
<pre><code>## Rows: 150
## Columns: 5
## $ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.…
## $ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
## $ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.…
## $ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
## $ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s…</code></pre>
<p>mutate() will allow you create and modify variables:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="module-2.html#cb115-1" aria-hidden="true" tabindex="-1"></a>iris1 <span class="ot">&lt;-</span> iris1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Plant=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Species), </span>
<span id="cb115-2"><a href="module-2.html#cb115-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">PetSep.Length=</span>Petal.Length<span class="sc">+</span>Sepal.Length, </span>
<span id="cb115-3"><a href="module-2.html#cb115-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lnPS.Len=</span><span class="fu">log</span>(PetSep.Length), </span>
<span id="cb115-4"><a href="module-2.html#cb115-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Genus=</span><span class="st">&#39;Iris&#39;</span>, </span>
<span id="cb115-5"><a href="module-2.html#cb115-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">GenSpp=</span><span class="fu">gsub</span>(<span class="st">&#39;.*^&#39;</span>, <span class="st">&#39;Iris_&#39;</span>, Species)) </span>
<span id="cb115-6"><a href="module-2.html#cb115-6" aria-hidden="true" tabindex="-1"></a>        <span class="do">## note that I am overwriting iris1. Use with caution</span></span></code></pre></div>
<p>summarize() calculates means, sd, min, max, etc. on a dataset</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="module-2.html#cb116-1" aria-hidden="true" tabindex="-1"></a>iris1 <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(Petal.Length))  <span class="do">## mean of Petal.Length in dplyr</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   `mean(Petal.Length)`
##                  &lt;dbl&gt;
## 1                 3.76</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="module-2.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iris1<span class="sc">$</span>Petal.Length) <span class="do">## mean of Petal.Length in base R</span></span></code></pre></div>
<pre><code>## [1] 3.758</code></pre>
<p>Here we summarize lnPS.Len by Species with both Tidyverse and base R:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="module-2.html#cb120-1" aria-hidden="true" tabindex="-1"></a>means_PetLen1 <span class="ot">&lt;-</span> iris1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="module-2.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Petal.Length=</span><span class="fu">mean</span>(Petal.Length)) <span class="do">## tidy code</span></span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="module-2.html#cb121-1" aria-hidden="true" tabindex="-1"></a>means_PetLen2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Petal.Length<span class="sc">~</span>Species, <span class="at">FUN=</span><span class="st">&quot;mean&quot;</span>, <span class="at">data=</span>iris1) <span class="do">## base R</span></span></code></pre></div>
<p>Here we summarize multiple variables by species use summarize_all()</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="module-2.html#cb122-1" aria-hidden="true" tabindex="-1"></a>means1 <span class="ot">&lt;-</span> iris1 <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="module-2.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Length, Sepal.Width, Petal.Length,</span>
<span id="cb122-3"><a href="module-2.html#cb122-3" aria-hidden="true" tabindex="-1"></a>         Petal.Width,lnPS.Len, Species) <span class="sc">%&gt;%</span>  </span>
<span id="cb122-4"><a href="module-2.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> </span>
<span id="cb122-5"><a href="module-2.html#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_all</span>(<span class="fu">list</span>(<span class="at">mean=</span>mean,<span class="at">sd=</span>sd,<span class="at">n=</span>length))</span>
<span id="cb122-6"><a href="module-2.html#cb122-6" aria-hidden="true" tabindex="-1"></a>means1</span></code></pre></div>
<pre><code>## # A tibble: 3 × 16
##   Species    Sepal.Length_me… Sepal.Width_mean Petal.Length_me… Petal.Width_mean
##   &lt;fct&gt;                 &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
## 1 setosa                 5.01             3.43             1.46            0.246
## 2 versicolor             5.94             2.77             4.26            1.33 
## 3 virginica              6.59             2.97             5.55            2.03 
## # … with 11 more variables: lnPS.Len_mean &lt;dbl&gt;, Sepal.Length_sd &lt;dbl&gt;,
## #   Sepal.Width_sd &lt;dbl&gt;, Petal.Length_sd &lt;dbl&gt;, Petal.Width_sd &lt;dbl&gt;,
## #   lnPS.Len_sd &lt;dbl&gt;, Sepal.Length_n &lt;int&gt;, Sepal.Width_n &lt;int&gt;,
## #   Petal.Length_n &lt;int&gt;, Petal.Width_n &lt;int&gt;, lnPS.Len_n &lt;int&gt;</code></pre>
</div>
<div id="reshape-data-for-better-usability" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Reshape data for better usability<a href="module-2.html#reshape-data-for-better-usability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is how we reshape data from wide to long:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="module-2.html#cb124-1" aria-hidden="true" tabindex="-1"></a>iris_long <span class="ot">&lt;-</span> iris1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> </span>
<span id="cb124-2"><a href="module-2.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(Sepal.Length, Sepal.Width, Petal.Length,</span>
<span id="cb124-3"><a href="module-2.html#cb124-3" aria-hidden="true" tabindex="-1"></a>                      Petal.Width, lnPS.Len), </span>
<span id="cb124-4"><a href="module-2.html#cb124-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;Trait&#39;</span>, </span>
<span id="cb124-5"><a href="module-2.html#cb124-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>)</span>
<span id="cb124-6"><a href="module-2.html#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris_long)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
## # Groups:   Species [1]
##   Species Plant PetSep.Length Genus GenSpp      Trait        value
##   &lt;fct&gt;   &lt;int&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;
## 1 setosa      1           6.5 Iris  Iris_setosa Sepal.Length  5.1 
## 2 setosa      1           6.5 Iris  Iris_setosa Sepal.Width   3.5 
## 3 setosa      1           6.5 Iris  Iris_setosa Petal.Length  1.4 
## 4 setosa      1           6.5 Iris  Iris_setosa Petal.Width   0.2 
## 5 setosa      1           6.5 Iris  Iris_setosa lnPS.Len      1.87
## 6 setosa      2           6.3 Iris  Iris_setosa Sepal.Length  4.9</code></pre>
<p>We can calculate the mean, sd, and n for each Species X trait combo and then calculate SE:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="module-2.html#cb126-1" aria-hidden="true" tabindex="-1"></a>means2 <span class="ot">&lt;-</span> iris_long <span class="sc">%&gt;%</span> </span>
<span id="cb126-2"><a href="module-2.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species,Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href="module-2.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(value), </span>
<span id="cb126-4"><a href="module-2.html#cb126-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd=</span><span class="fu">sd</span>(value), </span>
<span id="cb126-5"><a href="module-2.html#cb126-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span><span class="fu">length</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb126-6"><a href="module-2.html#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se=</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb126-7"><a href="module-2.html#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait<span class="sc">!=</span><span class="st">&#39;lnPS.Len&#39;</span>)</span>
<span id="cb126-8"><a href="module-2.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(means2)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
## # Groups:   Species [2]
##   Species    Trait         mean    sd     n     se
##   &lt;fct&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
## 1 setosa     Petal.Length 1.46  0.174    50 0.0246
## 2 setosa     Petal.Width  0.246 0.105    50 0.0149
## 3 setosa     Sepal.Length 5.01  0.352    50 0.0498
## 4 setosa     Sepal.Width  3.43  0.379    50 0.0536
## 5 versicolor Petal.Length 4.26  0.470    50 0.0665
## 6 versicolor Petal.Width  1.33  0.198    50 0.0280</code></pre>
<p>Note that the previous code could all be done in one piped command:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="module-2.html#cb128-1" aria-hidden="true" tabindex="-1"></a>means2a <span class="ot">&lt;-</span> iris1 <span class="sc">%&gt;%</span> </span>
<span id="cb128-2"><a href="module-2.html#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> </span>
<span id="cb128-3"><a href="module-2.html#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(Sepal.Length, Sepal.Width, Petal.Length,</span>
<span id="cb128-4"><a href="module-2.html#cb128-4" aria-hidden="true" tabindex="-1"></a>                      Petal.Width, lnPS.Len), <span class="at">names_to =</span> <span class="st">&#39;Trait&#39;</span>,</span>
<span id="cb128-5"><a href="module-2.html#cb128-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb128-6"><a href="module-2.html#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species,Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb128-7"><a href="module-2.html#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(value), </span>
<span id="cb128-8"><a href="module-2.html#cb128-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd=</span><span class="fu">sd</span>(value),</span>
<span id="cb128-9"><a href="module-2.html#cb128-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span><span class="fu">length</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-10"><a href="module-2.html#cb128-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se=</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb128-11"><a href="module-2.html#cb128-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait<span class="sc">!=</span><span class="st">&#39;lnPS.Len&#39;</span>)</span>
<span id="cb128-12"><a href="module-2.html#cb128-12" aria-hidden="true" tabindex="-1"></a>means2a</span></code></pre></div>
<pre><code>## # A tibble: 12 × 6
## # Groups:   Species [3]
##    Species    Trait         mean    sd     n     se
##    &lt;fct&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
##  1 setosa     Petal.Length 1.46  0.174    50 0.0246
##  2 setosa     Petal.Width  0.246 0.105    50 0.0149
##  3 setosa     Sepal.Length 5.01  0.352    50 0.0498
##  4 setosa     Sepal.Width  3.43  0.379    50 0.0536
##  5 versicolor Petal.Length 4.26  0.470    50 0.0665
##  6 versicolor Petal.Width  1.33  0.198    50 0.0280
##  7 versicolor Sepal.Length 5.94  0.516    50 0.0730
##  8 versicolor Sepal.Width  2.77  0.314    50 0.0444
##  9 virginica  Petal.Length 5.55  0.552    50 0.0780
## 10 virginica  Petal.Width  2.03  0.275    50 0.0388
## 11 virginica  Sepal.Length 6.59  0.636    50 0.0899
## 12 virginica  Sepal.Width  2.97  0.322    50 0.0456</code></pre>
<p>We can make plot, below are two plots to start with. One is ineffective and one is more effective.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="module-2.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>means2, <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>mean, <span class="at">fill=</span>Trait)) <span class="sc">+</span> </span>
<span id="cb130-2"><a href="module-2.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.25</span>), <span class="at">pch=</span><span class="dv">22</span>) <span class="sc">+</span></span>
<span id="cb130-3"><a href="module-2.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Floral part measurement (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-4"><a href="module-2.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>(mean<span class="sc">-</span>sd), <span class="at">ymax=</span>(mean<span class="sc">+</span>sd)), <span class="at">width=</span>.<span class="dv">2</span>,</span>
<span id="cb130-5"><a href="module-2.html#cb130-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.25</span>), <span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb130-6"><a href="module-2.html#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, </span>
<span id="cb130-7"><a href="module-2.html#cb130-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Petal Length&quot;</span>,<span class="st">&quot;Petal Width&quot;</span>,</span>
<span id="cb130-8"><a href="module-2.html#cb130-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Sepal Length&quot;</span>, <span class="st">&quot;Sepal Width&quot;</span>),</span>
<span id="cb130-9"><a href="module-2.html#cb130-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">option=</span><span class="st">&quot;magma&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-10"><a href="module-2.html#cb130-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="dv">2</span>, <span class="at">fill=</span><span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb130-11"><a href="module-2.html#cb130-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-101-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="module-2.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris_long <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="module-2.html#cb131-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(Trait<span class="sc">!=</span><span class="st">&#39;lnPS.Len&#39;</span>), <span class="fu">aes</span>(<span class="at">x=</span>Species, </span>
<span id="cb131-3"><a href="module-2.html#cb131-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">y=</span>value, </span>
<span id="cb131-4"><a href="module-2.html#cb131-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fill=</span>Species)) <span class="sc">+</span> </span>
<span id="cb131-5"><a href="module-2.html#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb131-6"><a href="module-2.html#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Trait, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb131-7"><a href="module-2.html#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Floral part measurement (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-8"><a href="module-2.html#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, </span>
<span id="cb131-9"><a href="module-2.html#cb131-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, </span>
<span id="cb131-10"><a href="module-2.html#cb131-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">begin=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb131-11"><a href="module-2.html#cb131-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-102-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="b.-data-management-part-2" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 2B. Data Management Part 2<a href="module-2.html#b.-data-management-part-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are still using the Iris data set as well as the tidyverse.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="module-2.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb132-2"><a href="module-2.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb132-3"><a href="module-2.html#cb132-3" aria-hidden="true" tabindex="-1"></a>iris1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris) <span class="co"># load iris and convert to tibble</span></span></code></pre></div>
<p>Here we make plot of sepal.length by sepal.width in wide format:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="module-2.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris1, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Width, <span class="at">y=</span>Sepal.Length)) <span class="sc">+</span> </span>
<span id="cb133-2"><a href="module-2.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;#39568CFF&quot;</span>) <span class="sc">+</span>   <span class="do">## color outside of aes() changes color of all points (ie. not mapped to a column)</span></span>
<span id="cb133-3"><a href="module-2.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species) <span class="sc">+</span></span>
<span id="cb133-4"><a href="module-2.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>,<span class="at">color=</span><span class="st">&quot;#39568CFF&quot;</span>, <span class="at">fill=</span><span class="st">&quot;#39568CFF&quot;</span>)<span class="sc">+</span></span>
<span id="cb133-5"><a href="module-2.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>We can reshape data for for comparing traits in different panels:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="module-2.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">### reshape data from wide to long</span></span>
<span id="cb134-2"><a href="module-2.html#cb134-2" aria-hidden="true" tabindex="-1"></a>iris_long <span class="ot">&lt;-</span> iris1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> </span>
<span id="cb134-3"><a href="module-2.html#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width), <span class="at">names_to =</span> <span class="st">&#39;Trait&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>)</span>
<span id="cb134-4"><a href="module-2.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris_long)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
## # Groups:   Species [1]
##   Species Trait        value
##   &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
## 1 setosa  Sepal.Length   5.1
## 2 setosa  Sepal.Width    3.5
## 3 setosa  Petal.Length   1.4
## 4 setosa  Petal.Width    0.2
## 5 setosa  Sepal.Length   4.9
## 6 setosa  Sepal.Width    3</code></pre>
<p>Now we make a plot comparing species with traits on different panels:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="module-2.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris_long , <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>value, <span class="at">fill=</span>Species)) <span class="sc">+</span> </span>
<span id="cb136-2"><a href="module-2.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb136-3"><a href="module-2.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Trait, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb136-4"><a href="module-2.html#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Floral part measurement (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-5"><a href="module-2.html#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, </span>
<span id="cb136-6"><a href="module-2.html#cb136-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, </span>
<span id="cb136-7"><a href="module-2.html#cb136-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb136-8"><a href="module-2.html#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="c.-data-exploration" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 2C. Data Exploration<a href="module-2.html#c.-data-exploration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For data exploration we need to load the following libraries:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="module-2.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb137-2"><a href="module-2.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agridat)</span>
<span id="cb137-3"><a href="module-2.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) </span>
<span id="cb137-4"><a href="module-2.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats) </span></code></pre></div>
<p>We will use the Iris dataset.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="module-2.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris) <span class="co"># load data (already exists in base R)</span></span>
<span id="cb138-2"><a href="module-2.html#cb138-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="dv">8</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="co"># plant data point for demo</span></span>
<span id="cb138-3"><a href="module-2.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris) <span class="co"># print first 6 lines of dataset</span></span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="module-2.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(iris) <span class="co"># print last 6 lines of dataset</span></span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 145          6.7         3.3          5.7         2.5 virginica
## 146          6.7         3.0          5.2         2.3 virginica
## 147          6.3         2.5          5.0         1.9 virginica
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<p>Here we use str() to print the ‘structure’ of dataset giving you info about each column or we can use glimpse().</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="module-2.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 7 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="module-2.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris) <span class="co"># glimpse is similar to str() in tidyverse</span></span></code></pre></div>
<pre><code>## Rows: 150
## Columns: 5
## $ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.…
## $ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
## $ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 7.0, 1.4, 1.5, 1.5, 1.…
## $ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
## $ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s…</code></pre>
<div id="distributions-summary-statistics" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Distributions &amp; summary statistics<a href="module-2.html#distributions-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can view histograms of petal lengths with this:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="module-2.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length)) <span class="sc">+</span> </span>
<span id="cb146-2"><a href="module-2.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">12</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-3"><a href="module-2.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb146-4"><a href="module-2.html#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(Petal.Length)),</span>
<span id="cb146-5"><a href="module-2.html#cb146-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb146-6"><a href="module-2.html#cb146-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb146-7"><a href="module-2.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span> <span class="fu">median</span>(Petal.Length)), </span>
<span id="cb146-8"><a href="module-2.html#cb146-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, </span>
<span id="cb146-9"><a href="module-2.html#cb146-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-111-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>We can also facet the histograms:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="module-2.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length)) <span class="sc">+</span> </span>
<span id="cb147-2"><a href="module-2.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">12</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb147-3"><a href="module-2.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span> </span>
<span id="cb147-4"><a href="module-2.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-112-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>We can use the summary() to examine mean, median, and ranges.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="module-2.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.400   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.795   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :7.000   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<p>We can also get a table of means and medians with this tidyverse code:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="module-2.html#cb150-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb150-2"><a href="module-2.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb150-3"><a href="module-2.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species,name) <span class="sc">%&gt;%</span> </span>
<span id="cb150-4"><a href="module-2.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(value),<span class="at">median=</span><span class="fu">median</span>(value)) </span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
## # Groups:   Species [3]
##    Species    name          mean median
##    &lt;fct&gt;      &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
##  1 setosa     Petal.Length 1.57    1.5 
##  2 setosa     Petal.Width  0.246   0.2 
##  3 setosa     Sepal.Length 5.01    5   
##  4 setosa     Sepal.Width  3.43    3.4 
##  5 versicolor Petal.Length 4.26    4.35
##  6 versicolor Petal.Width  1.33    1.3 
##  7 versicolor Sepal.Length 5.94    5.9 
##  8 versicolor Sepal.Width  2.77    2.8 
##  9 virginica  Petal.Length 5.55    5.55
## 10 virginica  Petal.Width  2.03    2   
## 11 virginica  Sepal.Length 6.59    6.5 
## 12 virginica  Sepal.Width  2.97    3</code></pre>
</div>
<div id="examining-for-outliers" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Examining for outliers<a href="module-2.html#examining-for-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Boxplots can be used to examine distribution and look for outliers:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="module-2.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span> </span>
<span id="cb152-2"><a href="module-2.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">width=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb152-3"><a href="module-2.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span> </span>
<span id="cb152-4"><a href="module-2.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-115-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>We can also use a dixon test for outliers or other tests like the grubbs test or Rosner test (for multiple outliers):</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="module-2.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(outliers)</span></code></pre></div>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="module-2.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="do">## grubbs test for outliers, highest then lowest. Other functions EnvStats::rosnerTest() can test for multiple outliers</span></span>
<span id="cb154-2"><a href="module-2.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grubbs.test</span>(iris<span class="sc">$</span>Petal.Length) <span class="do">## full dataset</span></span></code></pre></div>
<pre><code>## 
##  Grubbs test for one outlier
## 
## data:  iris$Petal.Length
## G = 1.80564, U = 0.97797, p-value = 1
## alternative hypothesis: highest value 7 is an outlier</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="module-2.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grubbs.test</span>(iris<span class="sc">$</span>Petal.Length[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&#39;setosa&#39;</span>]) <span class="do">## just species setosa</span></span></code></pre></div>
<pre><code>## 
##  Grubbs test for one outlier
## 
## data:  iris$Petal.Length[iris$Species == &quot;setosa&quot;]
## G = 6.765525, U = 0.046807, p-value &lt; 2.2e-16
## alternative hypothesis: highest value 7 is an outlier</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="module-2.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grubbs.test</span>(iris<span class="sc">$</span>Petal.Length[iris<span class="sc">$</span>Species<span class="sc">==</span><span class="st">&#39;setosa&#39;</span>], <span class="at">opposite=</span>T) <span class="do">## test lower outlier for species setosa</span></span></code></pre></div>
<pre><code>## 
##  Grubbs test for one outlier
## 
## data:  iris$Petal.Length[iris$Species == &quot;setosa&quot;]
## G = 0.71295, U = 0.98941, p-value = 1
## alternative hypothesis: lowest value 1 is an outlier</code></pre>
<p>Here we can remove outliers and remake boxplots. Filtering with “|” (OR) will select all observations where one condition is met but not the other.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="module-2.html#cb160-1" aria-hidden="true" tabindex="-1"></a>iris1 <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Petal.Length<span class="sc">&lt;</span><span class="dv">4</span> <span class="sc">|</span> <span class="sc">!</span>Species<span class="sc">==</span><span class="st">&#39;setosa&#39;</span>)</span></code></pre></div>
<p>Ploting data:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="module-2.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris1, <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span> </span>
<span id="cb161-2"><a href="module-2.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="at">width=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb161-3"><a href="module-2.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span> </span>
<span id="cb161-4"><a href="module-2.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-119-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="explore-relationships" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Explore relationships<a href="module-2.html#explore-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can first use the GGally package. The ggpairs() code provides us with scatter plots that plot variables against one another in a pairwise fashion. We also see the distribution of the data and the correlation coefficients between a pair of variables</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="module-2.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="do">## install and load GGally package, if necessary</span></span></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="module-2.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(iris1)   <span class="do">## Make a big panel plot for exploration!!!</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-121-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="module-2.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(iris1, <span class="fu">aes</span>(<span class="at">color=</span>Species, <span class="at">alpha=</span>.<span class="dv">75</span>)) <span class="do">## add color to seperate by species</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-121-2.png" width="960" style="display: block; margin: auto;" /></p>
<p>Alternative to ggpairs() is the cor() which can be better for quickly scanning complex datasets:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="module-2.html#cb165-1" aria-hidden="true" tabindex="-1"></a>iris_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(iris1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()) <span class="do">## first make correlation matrix</span></span>
<span id="cb165-2"><a href="module-2.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(iris_cor, <span class="at">method =</span> <span class="st">&quot;circle&quot;</span>, <span class="at">type =</span> <span class="st">&quot;upper&quot;</span>) <span class="do">## plots strength of correlation as color-coded circles</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-122-1.png" width="960" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="module-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-Module_2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
