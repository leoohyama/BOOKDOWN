<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Introduction to Regression | Module 2</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Introduction to Regression | Module 2" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Introduction to Regression | Module 2" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Leo Ohyama" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-data-visualization.html"/>
<link rel="next" href="regression-challenge.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>1.2</b> Render book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>1.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Visualization</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#continuous-variables"><i class="fa fa-check"></i><b>2.1</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#scatterplots-with-base-r"><i class="fa fa-check"></i><b>2.1.1</b> Scatterplots with base R</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#scatterplots-with-ggplot2"><i class="fa fa-check"></i><b>2.1.2</b> Scatterplots with ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#fancy-scatterplots"><i class="fa fa-check"></i><b>2.2</b> Fancy Scatterplots</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#continuous-variables-1"><i class="fa fa-check"></i><b>2.3</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#boxplots-with-base-r"><i class="fa fa-check"></i><b>2.3.1</b> Boxplots with base R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#different-types-of-plots-for-categorical-data-with-ggplot2"><i class="fa fa-check"></i><b>2.4</b> Different types of plots for categorical data with ggplot2</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#adding-colors-and-summary-statistics-e.g.-averages-to-plots"><i class="fa fa-check"></i><b>2.4.1</b> Adding colors and summary statistics (e.g. averages) to plots</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-data-visualization.html"><a href="introduction-to-data-visualization.html#breakout-group-challenge"><i class="fa fa-check"></i><b>2.5</b> Breakout group challenge</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html"><i class="fa fa-check"></i><b>3</b> Introduction to Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#an-example-of-linear-regression-in-r"><i class="fa fa-check"></i><b>3.1</b> An Example of Linear Regression in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression-challenge.html"><a href="regression-challenge.html"><i class="fa fa-check"></i><b>4</b> Regression Challenge</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regression-challenge.html"><a href="regression-challenge.html#introduction-to-anova"><i class="fa fa-check"></i><b>4.1</b> Introduction to ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="example-of-a-one-way-anova-in-r.html"><a href="example-of-a-one-way-anova-in-r.html"><i class="fa fa-check"></i><b>5</b> Example of a one-way ANOVA in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="example-of-a-one-way-anova-in-r.html"><a href="example-of-a-one-way-anova-in-r.html#anova-challenge"><i class="fa fa-check"></i><b>5.1</b> ANOVA Challenge</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html"><i class="fa fa-check"></i><b>6</b> Extra Data Visualization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#adding-averages-to-plots-part-2"><i class="fa fa-check"></i><b>6.1</b> Adding averages to plots part 2</a></li>
<li class="chapter" data-level="6.2" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#r-challenge"><i class="fa fa-check"></i><b>6.2</b> R Challenge</a></li>
<li class="chapter" data-level="6.3" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#a.-data-management-part-1"><i class="fa fa-check"></i><b>6.3</b> 2A. Data Management Part 1</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#making-and-modifying-variables"><i class="fa fa-check"></i><b>6.3.1</b> Making and modifying variables</a></li>
<li class="chapter" data-level="6.3.2" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#variables-with-the-tidyverse"><i class="fa fa-check"></i><b>6.3.2</b> Variables with the tidyverse</a></li>
<li class="chapter" data-level="6.3.3" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#reshape-data-for-better-usability"><i class="fa fa-check"></i><b>6.3.3</b> Reshape data for better usability</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#b.-data-management-part-2"><i class="fa fa-check"></i><b>6.4</b> 2B. Data Management Part 2</a></li>
<li class="chapter" data-level="6.5" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#c.-data-exploration"><i class="fa fa-check"></i><b>6.5</b> 2C. Data Exploration</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#distributions-summary-statistics"><i class="fa fa-check"></i><b>6.5.1</b> Distributions &amp; summary statistics</a></li>
<li class="chapter" data-level="6.5.2" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#examining-for-outliers"><i class="fa fa-check"></i><b>6.5.2</b> Examining for outliers</a></li>
<li class="chapter" data-level="6.5.3" data-path="extra-data-visualization.html"><a href="extra-data-visualization.html#explore-relationships"><i class="fa fa-check"></i><b>6.5.3</b> Explore relationships</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Module 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-regression" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Introduction to Regression<a href="introduction-to-regression.html#introduction-to-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="an-example-of-linear-regression-in-r" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> An Example of Linear Regression in R<a href="introduction-to-regression.html#an-example-of-linear-regression-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this section we will use the tidyverse and car package. The functon to actually run a linear regression (lm()) is built into the base R libraries</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="introduction-to-regression.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb44-2"><a href="introduction-to-regression.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<p>We should also set a seed to make things reproducible. This is because for this section we will generate random numbers to create a dataset that we can use to apply a linear model to. Because we want to make sure that the same random numbers are generated for all who use this, we can do this by setting a seed. If everyone uses the same seed they will get the same random numbers that are generated from the following code:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="introduction-to-regression.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Set Seed</span></span>
<span id="cb45-2"><a href="introduction-to-regression.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21</span>)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="introduction-to-regression.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random data</span></span>
<span id="cb46-2"><a href="introduction-to-regression.html#cb46-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">20</span>,<span class="dv">12</span>,<span class="dv">30</span>), <span class="dv">2</span>)            </span>
<span id="cb46-3"><a href="introduction-to-regression.html#cb46-3" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">5</span><span class="sc">*</span>temp,<span class="dv">25</span>), <span class="dv">2</span>)</span>
<span id="cb46-4"><a href="introduction-to-regression.html#cb46-4" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(temp,mass)) </span></code></pre></div>
<p>This is the random data set:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="introduction-to-regression.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(r1)</span></code></pre></div>
<pre><code>##    temp   mass
## 1 26.15  73.83
## 2 16.54 101.64
## 3 24.59 109.24
## 4 15.32  80.91
## 5 29.27 160.42
## 6 28.54 180.50</code></pre>
<p>Temp would represent rearing temperature in celsius and mass is the mass of adults in milligrams. Let’s plot this data</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="introduction-to-regression.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(r1, <span class="fu">aes</span>(<span class="at">x=</span>temp, <span class="at">y=</span>mass))<span class="sc">+</span></span>
<span id="cb49-2"><a href="introduction-to-regression.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb49-3"><a href="introduction-to-regression.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Now let’s construct a linear model to estimate the average adult mass per degree C of temperature increase. For a continuous variable (temp in celsius), we are interested in estimating the slope between mass and temperature.</p>
<p>We can set up the model using lm(). The varibale specified before “~” is your response (mass in this case) and the variable specified after is your predictor (temperature in this case).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="introduction-to-regression.html#cb50-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mass<span class="sc">~</span>temp, <span class="at">data=</span>r1) <span class="co"># all  &quot;calculations&quot; are saved in an object we called &#39;lm1&#39;</span></span></code></pre></div>
<p>We can construct an ANOVA table of this model. The ANOVA table tests the null hypothesis that the slope is different than zero. It’s not not super useful for regressions but useful to look at.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="introduction-to-regression.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(lm1, <span class="at">type=</span><span class="dv">2</span>)  </span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mass
##           Sum Sq Df F value    Pr(&gt;F)    
## temp       13001  1  23.137 0.0001403 ***
## Residuals  10114 18                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To see the summary of the model (e.g. model coefficients) we use summary()</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="introduction-to-regression.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mass ~ temp, data = r1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -50.349 -13.588   0.361  15.668  45.873 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.8626    20.0788   0.491  0.62922    
## temp          4.3716     0.9088   4.810  0.00014 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 23.7 on 18 degrees of freedom
## Multiple R-squared:  0.5624, Adjusted R-squared:  0.5381 
## F-statistic: 23.14 on 1 and 18 DF,  p-value: 0.0001403</code></pre>
<p>The coefficients allow you rebuild the means from the linear model equation:
<span class="math display">\[y = \beta _0 + \beta _1X \]</span>
For continuous variables these coefficients and p-values are very useful (unlike for categorical ANOVA). Ultimately, you don’t really need to look at ANOVA table or use emmeans for this type of analysis, everything of interest is in summary.</p>
<p>We can also look at the model coefficients with coef() or we can actually index the coefficients by using lm1$coef.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="introduction-to-regression.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm1)</span></code></pre></div>
<pre><code>## (Intercept)        temp 
##    9.862553    4.371578</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="introduction-to-regression.html#cb57-1" aria-hidden="true" tabindex="-1"></a>lm1<span class="sc">$</span>coef   </span></code></pre></div>
<pre><code>## (Intercept)        temp 
##    9.862553    4.371578</code></pre>
<p>We can make a plot with the best-fit regression line and intercept.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="introduction-to-regression.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(r1, <span class="fu">aes</span>(<span class="at">x=</span>temp, <span class="at">y=</span>mass))<span class="sc">+</span></span>
<span id="cb59-2"><a href="introduction-to-regression.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb59-3"><a href="introduction-to-regression.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-4"><a href="introduction-to-regression.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>To check assumptions of the model, we examine residuals.</p>
<p>We can check normality of residuals with a histogram.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="introduction-to-regression.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lm1<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>We can check the homogenity of the residuals by plotting the residuals against the model’s fitted values. The residuals should be evenly dispersed around 0 across the range of x’s. Funnel shapes or curvature in the dispersion would indicate violations.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="introduction-to-regression.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm1<span class="sc">$</span>residuals<span class="sc">~</span>lm1<span class="sc">$</span>fitted.values) </span>
<span id="cb61-2"><a href="introduction-to-regression.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)  </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Using the car package we can also make a qqplot. Residuals should line up pretty closely to the blue line and points that drift from line may be outliers.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="introduction-to-regression.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(lm1<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="960" style="display: block; margin: auto;" /></p>
<pre><code>## [1] 1 6</code></pre>
<p>To find out which specific points are outliers we can use leveragePlots().</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="introduction-to-regression.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveragePlots</span>(lm1) <span class="co"># codes points that may be outliers</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Problems with residuals indicate assumptions of the linear model are violated and may cause problems with coefficients and p-values. To alleviate potential issues transforming the data may help. It’s useful to note that assumptions can be slightly violated without causing problems.</p>
<p>We can also make a fancy plot of this model.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="introduction-to-regression.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(r1, <span class="fu">aes</span>(<span class="at">x=</span>temp,</span>
<span id="cb65-2"><a href="introduction-to-regression.html#cb65-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span>mass)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="introduction-to-regression.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="introduction-to-regression.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="introduction-to-regression.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Temperature&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Mass&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-6"><a href="introduction-to-regression.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb65-7"><a href="introduction-to-regression.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-data-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression-challenge.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-Module_1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
